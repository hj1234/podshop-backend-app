{% extends "base.html" %}

{% block content %}
<div class="page-header">
    <h2>Historical Games</h2>
    {% if total is defined %}
    <span style="color: #888; font-size: 0.875rem;">Total: {{ total }}</span>
    {% endif %}
</div>

{% if games %}
<table>
    <thead>
        <tr>
            <th>ID</th>
            <th>Fund Name</th>
            <th>Time Started</th>
            <th>Time Ended</th>
            <th>Time Played</th>
            <th>Completed</th>
            <th>Total PnL</th>
            <th>Geolocation</th>
            <th>Created At</th>
        </tr>
    </thead>
    <tbody>
        {% for game in games %}
        <tr>
            <td><code>{{ game.id }}</code></td>
            <td><strong>{{ game.fund_name }}</strong></td>
            <td>{{ game.time_started }}</td>
            <td>{{ game.time_ended or 'N/A' }}</td>
            <td>{{ game.time_played or '—' }}</td>
            <td>
                {% if game.completed %}
                    <span style="color: #4caf50;">✓</span>
                {% else %}
                    <span style="color: #f44336;">✗</span>
                {% endif %}
            </td>
            <td>
                {% if game.total_pnl is not none %}
                    {% if game.total_pnl >= 0 %}
                        <span style="color: #4caf50;">${{ "{:,.0f}".format(game.total_pnl) }}</span>
                    {% else %}
                        <span style="color: #f44336;">${{ "{:,.0f}".format(game.total_pnl) }}</span>
                    {% endif %}
                {% else %}
                    <span style="color: #888;">—</span>
                {% endif %}
            </td>
            <td><code>{{ game.geolocation or 'N/A' }}</code></td>
            <td>{{ game.created_at }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% if total_pages > 1 %}
<div class="pagination" style="margin-top: 2rem; display: flex; justify-content: space-between; align-items: center;">
    <div style="color: #888; font-size: 0.875rem;">
        Showing {{ ((page - 1) * limit) + 1 }} to {{ [page * limit, total]|min }} of {{ total }} games
    </div>
    <div style="display: flex; gap: 0.5rem; align-items: center;">
        {% if page > 1 %}
        <a href="?page={{ page - 1 }}&limit={{ limit }}" class="btn btn-secondary btn-sm">Previous</a>
        {% else %}
        <span class="btn btn-secondary btn-sm" style="opacity: 0.5; cursor: not-allowed;">Previous</span>
        {% endif %}
        
        <span style="color: #888; padding: 0 1rem;">
            Page {{ page }} of {{ total_pages }}
        </span>
        
        {% if page < total_pages %}
        <a href="?page={{ page + 1 }}&limit={{ limit }}" class="btn btn-secondary btn-sm">Next</a>
        {% else %}
        <span class="btn btn-secondary btn-sm" style="opacity: 0.5; cursor: not-allowed;">Next</span>
        {% endif %}
    </div>
</div>
{% endif %}

{% else %}
<p style="color: #888; text-align: center; padding: 3rem;">No historical games.</p>
{% endif %}
{% endblock %}

